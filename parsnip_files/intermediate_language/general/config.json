{
    "ParsnipVersion": "1.0",
    "Protocol": "HART_IP",
    "protocolShortDescription": "HART-IP is the IP extension of the Highway Addressable Remote Transducer (HART) protocol.",
    "protocolLongDescription": "HART-IP is the IP extension of the Highway Addressable Remote Transducer (HART) protocol.\nThe HART protocol is a hybrid analog+digital industrial automation open protocol.\nIt is currently maintained by the FieldComm Group (https://www.fieldcommgroup.org/).",
    "Ports": [
        {
            "protocol": "tcp",
            "port": 5094
        },
        {
            "protocol": "udp",
            "port": 5094
        }
    ],
    "usesTCP": true,
    "usesUDP": true,
    "usesLayer2": false,
    "conversionFile": "I2luY2x1ZGUgPHN0cmluZz4KI2luY2x1ZGUgPGlvc3RyZWFtPgojaW5jbHVkZSA8YWxnb3JpdGhtPgojaW5jbHVkZSA8cmFuZG9tPgojaW5jbHVkZSA8aGlsdGkvcnQvbGliaGlsdGkuaD4KI2luY2x1ZGUgPHNwaWN5L3J0L2xpYnNwaWN5Lmg+CgpuYW1lc3BhY2UgSEFSVF9JUF9DT05WRVJTSU9OCnsKICAgIHN0ZDo6c3RyaW5nIGxhdGluMUNvbnZlcnNpb24oY29uc3QgaGlsdGk6OnJ0OjpCeXRlcyAmZGF0YSkgICAgewogICAgICAgIHN0ZDo6c3RyaW5nIHJldHVyblZhbHVlOwogICAgICAgIGNvbnN0IGNoYXIgKmNoYXJfcHRyID0gKGNvbnN0IGNoYXIgKikgZGF0YS5kYXRhKCk7CiAgICAgICAgZm9yKHN0ZDo6c2l6ZV90IGkgPSAwOyBpIDwgZGF0YS5zaXplKCk7ICsraSkKICAgICAgICB7CiAgICAgICAgICAgIC8vaWYoMCA9PSBjaGFyX3B0cltpXSkKICAgICAgICAgICAgLy97CiAgICAgICAgICAgIC8vICAgIGJyZWFrOwogICAgICAgICAgICAvL30KICAgICAgICAgICAgcmV0dXJuVmFsdWUgKz0gY2hhcl9wdHJbaV07CiAgICAgICAgfQogICAgICAgIHJldHVybiByZXR1cm5WYWx1ZTsKICAgIH0KCiAgICBzdGQ6OnN0cmluZyBkYXRlQ29udmVyc2lvbihjb25zdCBoaWx0aTo6cnQ6OkJ5dGVzICZkYXRhKSAgICB7CiAgICAgICAgaWYoZGF0YS5zaXplKCkgPCAzKQogICAgICAgIHsKICAgICAgICAgICAgcHJpbnRmKCJbZXJyb3JdIERhdGUgVHlwZSBJbXByb3BlciBCeXRlIExlbmd0aCAoJWxpKSwgbXVzdCBiZSAzXG4iLCBkYXRhLnNpemUoKSk7CiAgICAgICAgICAgIHJldHVybiAiIjsKICAgICAgICB9CgogICAgICAgIGNvbnN0IGNoYXIgKmNoYXJfcHRyID0gKGNvbnN0IGNoYXIgKikgZGF0YS5kYXRhKCk7CgogICAgICAgIHVuc2lnbmVkIGNoYXIgZGF5ID0gY2hhcl9wdHJbMF07CiAgICAgICAgdW5zaWduZWQgY2hhciBtb250aCA9IGNoYXJfcHRyWzFdOwogICAgICAgIHVuc2lnbmVkIGNoYXIgc2hvcnRZZWFyID0gY2hhcl9wdHJbMl07CiAgICAgICAgdW5zaWduZWQgaW50IGxvbmdZZWFyID0gMTkwMCArIHNob3J0WWVhcjsKCiAgICAgICAgcmV0dXJuIHN0ZDo6dG9fc3RyaW5nKG1vbnRoKSArICItIiArCiAgICAgICAgICAgICAgIHN0ZDo6dG9fc3RyaW5nKGRheSkgKyAiLSIgKwogICAgICAgICAgICAgICBzdGQ6OnRvX3N0cmluZyhsb25nWWVhcik7CiAgICB9CgogICAgc3RkOjpzdHJpbmcgdGltZUNvbnZlcnNpb24oY29uc3QgaGlsdGk6OnJ0OjpCeXRlcyAmZGF0YSkgICAgewogICAgICAgIGNvbnN0IHVuc2lnbmVkIGludCBNSUxMSVNFQ09ORF9QQVJUUyA9IDMyOwogICAgICAgIGNvbnN0IHVuc2lnbmVkIGludCBTRUNPTkRTX1BFUl9NSU5VVEUgPSA2MDsKICAgICAgICBjb25zdCB1bnNpZ25lZCBpbnQgTUlOVVRFU19QRVJfSE9VUiA9IDYwOwogICAgICAgIGlmKGRhdGEuc2l6ZSgpIDwgNCkKICAgICAgICB7CiAgICAgICAgICAgIHByaW50ZigiW2Vycm9yXSBUaW1lIFR5cGUgSW1wcm9wZXIgQnl0ZSBMZW5ndGggKCVsaSksIG11c3QgYmUgNFxuIiwgZGF0YS5zaXplKCkpOwogICAgICAgICAgICByZXR1cm4gIiI7CiAgICAgICAgfQogICAgICAgIGNvbnN0IGNoYXIgKmNoYXJfcHRyID0gKGNvbnN0IGNoYXIgKikgZGF0YS5kYXRhKCk7CiAgICAgICAgdW5zaWduZWQgaW50IHRpbWUgPSAwOwogICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCA0OyArK2kpCiAgICAgICAgewogICAgICAgICAgICB0aW1lIDw8PSA4OwogICAgICAgICAgICB0aW1lIHw9ICh1bnNpZ25lZCBjaGFyKWNoYXJfcHRyW2ldOwogICAgICAgIH0KICAgICAgICAvL3ByaW50ZigiVGltZTogJXVcbiIsIHRpbWUpOwogICAgICAgIGZsb2F0IGZyYWN0aW9uUGFydCA9IChmbG9hdCkodGltZSAlIE1JTExJU0VDT05EX1BBUlRTKS8oZmxvYXQpTUlMTElTRUNPTkRfUEFSVFM7CiAgICAgICAgdW5zaWduZWQgaW50IHRvdGFsU2Vjb25kcyA9IHRpbWUgLyBNSUxMSVNFQ09ORF9QQVJUUzsgLy8gU2FtZSBhcyB0aW1lID4+IDUKICAgICAgICB1bnNpZ25lZCBpbnQgc2Vjb25kc1BhcnQgPSB0b3RhbFNlY29uZHMgJSBTRUNPTkRTX1BFUl9NSU5VVEU7CiAgICAgICAgdW5zaWduZWQgaW50IHRvdGFsTWludXRlcyA9IHRvdGFsU2Vjb25kcyAvIFNFQ09ORFNfUEVSX01JTlVURTsKICAgICAgICB1bnNpZ25lZCBpbnQgbWludXRlc1BhcnQgPSB0b3RhbE1pbnV0ZXMgJSBNSU5VVEVTX1BFUl9IT1VSOwogICAgICAgIHVuc2lnbmVkIGludCBob3Vyc1BhcnQgPSB0b3RhbE1pbnV0ZXMgLyBNSU5VVEVTX1BFUl9IT1VSOwoKICAgICAgICBzdGQ6OnN0cmluZyByZXR1cm5TdHJpbmcgPSAiIjsKICAgICAgICBzdGQ6OnN0cmluZyB0ZW1wU3RyaW5nID0gIiI7CiAgICAgICAgaWYoMCA8IHNlY29uZHNQYXJ0IHx8IDAuMCA8IGZyYWN0aW9uUGFydCkKICAgICAgICB7CiAgICAgICAgICAgIHJldHVyblN0cmluZyA9IHN0ZDo6dG9fc3RyaW5nKGZyYWN0aW9uUGFydCArIHNlY29uZHNQYXJ0KSArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICIgc2Vjb25kcyBzaW5jZSBtaWRuaWdodCI7CiAgICAgICAgfQogICAgICAgIGlmKDAgPCBtaW51dGVzUGFydCkKICAgICAgICB7CiAgICAgICAgICAgIHRlbXBTdHJpbmcgPSBzdGQ6OnRvX3N0cmluZyhtaW51dGVzUGFydCkgKyAiIG1pbnV0ZXMiOwogICAgICAgICAgICBpZigiIiAhPSByZXR1cm5TdHJpbmcpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHRlbXBTdHJpbmcgKz0gIiwgIjsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm5TdHJpbmcgPSB0ZW1wU3RyaW5nICsgcmV0dXJuU3RyaW5nOwogICAgICAgIH0KICAgICAgICBpZigwIDwgaG91cnNQYXJ0KQogICAgICAgIHsKICAgICAgICAgICAgdGVtcFN0cmluZyA9IHN0ZDo6dG9fc3RyaW5nKGhvdXJzUGFydCkgKyAiIGhvdXJzIjsKICAgICAgICAgICAgaWYoIiIgIT0gcmV0dXJuU3RyaW5nKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB0ZW1wU3RyaW5nICs9ICIsICI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuU3RyaW5nID0gdGVtcFN0cmluZyArIHJldHVyblN0cmluZzsKICAgICAgICB9CgogICAgICAgIHJldHVybiByZXR1cm5TdHJpbmc7CiAgICB9CgogICAgc3RkOjpzdHJpbmcgcGFja2VkQ29udmVyc2lvbihjb25zdCBoaWx0aTo6cnQ6OkJ5dGVzICZkYXRhKSAgICB7CiAgICAgICAgY29uc3QgaW50IElOUFVUX0NIQVJTID0gMzsKICAgICAgICBjb25zdCBpbnQgT1VUUFVUX0NIQVJTID0gNDsKICAgICAgICBjb25zdCBpbnQgQklUU19QRVJfQllURSA9IDg7CiAgICAgICAgY29uc3QgaW50IE5FRURFRF9CSVRTID0gQklUU19QRVJfQllURSAvIE9VVFBVVF9DSEFSUyAqIElOUFVUX0NIQVJTOwogICAgICAgIC8vIE1BUCBmcm9tIFRTMjAwOTkgKHYxMS4wKSA1LjEuMSwgVGFibGUgMQogICAgICAgIC8vIE5vdGU6IHRoZXJlIGFyZSBvdGhlciB3YXlzIHRvIGRvIHRoaXMsIHRoaXMganVzdCBzZWVtcyBlYXN5IGZvciBub3cuCiAgICAgICAgY29uc3Qgc3RkOjpzdHJpbmcgTUFQID0gIkBBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWltcXF1eXyAhXCIjJCUmJygpKissLS4vMDEyMzQ1Njc4OTo7PD0+PyI7CiAgICAgICAgICAgIAogICAgICAgIGlmKDAgIT0gZGF0YS5zaXplKCkgJSBJTlBVVF9DSEFSUykKICAgICAgICB7CiAgICAgICAgICAgIHByaW50ZigiW2Vycm9yXSBQYWNrZWQgVHlwZSBJbXByb3BlciBCeXRlIExlbmd0aCAoJWxpKSwgbXVzdCBiZSBkaXZpc2libGUgYnkgJWlcbiIsIGRhdGEuc2l6ZSgpLCBJTlBVVF9DSEFSUyk7CiAgICAgICAgICAgIHJldHVybiAiIjsKICAgICAgICB9CiAgICAgICAgc3RkOjpzdHJpbmcgb3V0cHV0U3RyaW5nOwoKICAgICAgICB1bnNpZ25lZCBjaGFyIHRlbXBDaGFyID0gMDsKICAgICAgICBpbnQgcHJvY2Vzc2VkQml0cyA9IDA7CiAgICAgICAgY29uc3QgY2hhciAqY2hhcl9wdHIgPSAoY29uc3QgY2hhciAqKSBkYXRhLmRhdGEoKTsKICAgICAgICBmb3Ioc3RkOjpzaXplX3QgaSA9IDA7IGkgPCBkYXRhLnNpemUoKTsgKytpKQogICAgICAgIHsKICAgICAgICAgICAgLy8gQ2FuIHdlIGJlIHNtYXJ0ZXIgYWJvdXQgdGhpcz8gKGkuZS4sIG5vdCByZWFkIGp1c3Qgb25lIGJpdCBhdCBhIHRpbWUpCiAgICAgICAgICAgIGZvcihpbnQgaiA9IEJJVFNfUEVSX0JZVEUgLSAxOyBqID49IDA7IC0taikKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgLy8gU2hpZnQgY3VycmVudCBiaXRzCiAgICAgICAgICAgICAgICB0ZW1wQ2hhciA8PD0gMTsKICAgICAgICAgICAgICAgIC8vIFJlYWQgdGhlIG5leHQgYml0CiAgICAgICAgICAgICAgICBpZihjaGFyX3B0cltpXSAmICgxIDw8IGopKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIC8vIEJpdCB3YXMgc2V0LCBjb3B5IGl0IG92ZXIKICAgICAgICAgICAgICAgICAgICB0ZW1wQ2hhciB8PSAxOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYoMCA9PSArK3Byb2Nlc3NlZEJpdHMgJSBORUVERURfQklUUykKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAvLyBXZSBoYXZlIGNvbGxlY3RlZCB0aGUgbmV4dCBzZXQgb2YgTkVFREVEX0JJVFMsIHRpbWUgdG8gbWFwIGFuZAogICAgICAgICAgICAgICAgICAgIC8vIHJldHVybiBhIGNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgIGlmKHRlbXBDaGFyIDwgTUFQLnNpemUoKSkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dFN0cmluZyArPSBNQVBbdGVtcENoYXJdOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBwcmludGYoIltlcnJvcl0gUGFja2VkIFR5cGUgSW1wcm9wZXIgQ2hhcmFjdGVyIEVuY29kaW5nXG4iKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICIiOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAvLyBSZXNldCB0aGluZ3MgaW4gcHJlcGFyYXRpb24gZm9yIHRoZSBuZXh0IHNldCBvZiBORUVERURfQklUUwogICAgICAgICAgICAgICAgICAgIHByb2Nlc3NlZEJpdHMgPSAwOwogICAgICAgICAgICAgICAgICAgIHRlbXBDaGFyID0gMDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIG91dHB1dFN0cmluZzsKICAgIH0KCn0KCg==",
    "signatureFile": "IyBDb3B5cmlnaHQgKGMpIDIwMjMgYnkgQmF0dGVsbGUgRW5lcmd5IEFsbGlhbmNlCgojIFRoZSBzcGVjaWZpYyB2ZXJzaW9uIG9mIEhBUlQtSVAgdXNlZCB0byBjcmVhdGUgdGhpcyBwYXJzZXIKIyBGaXJzdCBieXRlOiAweDAyIGFjY29yZGluZyB0byBzcGVjLCAweDAxIGFjY29yZGluZyB0byBvdXIgdGVzdCBkYXRhCiMgU2Vjb25kIGJ5dGU6IDB4MDAgLSAweDAyLCAweDBGCiMgVGhpcmQgYnl0ZTogMHgwMCAtIDB4MDUKIyBGb3VydGggYnl0ZTogMHgwMCwgMHgwMiwgMHgwNSwgMHgwNiwgMHgwOCwgMHgwOSwgMHgwZSwgMHgwZiwgMHgxMCwgMHgxZQoKc2lnbmF0dXJlIGRwZF9oYXJ0X2lwIHsKICAgICNwYXlsb2FkIC9eW1x4MDFceDAyXVtceDAwLVx4MDJceDBmXVtceDAwLVx4MDVdW1x4MDBceDAyXHgwNVx4MDZceDA4XHgwOVx4MGVceDBmXHgxMFx4MWVdLwogICAgcGF5bG9hZC9eW1x4MDFceDAyXVtceDAwLVx4MDJceDBmXShceDAwW1x4MDBceDA1XHgwNlx4MDhceDA5XHgwZVx4MGZceDEwXHgxZV1bXHgwMC1ceGZmXXsyfVx4MDBceDBkW1x4MDAtXHhmZl17NX0pfChceDAxW1x4MDBceDA2XVtceDAwLVx4ZmZdezJ9XHgwMFx4MDgpfChceDAyW1x4MDBceDA2XVtceDAwLVx4ZmZdezJ9XHgwMFx4MDgpfChceDAzW1x4MDBceDA2XHgxMF1bXHgwMC1ceGZmXXs2fShbXHgwMC1ceGZmXXs0fSk/W1x4MDAtXHhmZl17Myx9KXwoXHgwNFtceDAwXHgwNlx4MTBdW1x4MDAtXHhmZl17Nn0oW1x4MDAtXHhmZl17Myx9KSspfChceDA1W1x4MDBceDA2XHgwOF1bXHgwMC1ceGZmXXs2fShbXHgwMC1ceGZmXXsxN31bXHgwMC1ceDA3XVtceDAwLVx4ZmZdezJ9KFtceDAwLVx4ZmZdezQwfVtceDAwLVx4MWZdW1x4MDAtXHhmZl17MTZ9KSspPykvCn0KCnNpZ25hdHVyZSBkcGRfaGFydF9pcF90Y3AgewogIGlwLXByb3RvID09IHRjcAogIHJlcXVpcmVzLXNpZ25hdHVyZSBkcGRfaGFydF9pcAogIGVuYWJsZSAic3BpY3lfSEFSVF9JUF9UQ1AiCn0KCnNpZ25hdHVyZSBkcGRfaGFydF9pcF91ZHAgewogIGlwLXByb3RvID09IHVkcAogIHJlcXVpcmVzLXNpZ25hdHVyZSBkcGRfaGFydF9pcAogIGVuYWJsZSAic3BpY3lfSEFSVF9JUF9VRFAiCn0K",
    "CustomFieldTypes": [
        {
            "name": "latin-1",
            "interpretingFunction": "latin1Conversion",
            "returnType": "string"
        },
        {
            "name": "Date",
            "interpretingFunction": "dateConversion",
            "returnType": "string"
        },
        {
            "name": "Time",
            "interpretingFunction": "timeConversion",
            "returnType": "string"
        },
        {
            "name": "Packed",
            "interpretingFunction": "packedConversion",
            "returnType": "string"
        }
    ],
    "EntryPoint": "general.Message",
    "Scopes": [
        "general",
        "common_commands",
        "universal_commands"
    ]
}
{
    "ParsnipVersion": "1.0",
    "Protocol": "HART_IP",
    "protocolShortDescription": "HART-IP is the IP extension of the Highway Addressable Remote Transducer (HART) protocol.",
    "protocolLongDescription": "HART-IP is the IP extension of the Highway Addressable Remote Transducer (HART) protocol.\nThe HART protocol is a hybrid analog+digital industrial automation open protocol.\nIt is currently maintained by the FieldComm Group (https://www.fieldcommgroup.org/).",
    "Ports": [
        {
            "protocol": "tcp",
            "port": 5094
        },
        {
            "protocol": "udp",
            "port": 5094
        }
    ],
    "usesTCP": true,
    "usesUDP": true,
    "usesLayer2": false,
    "conversionFile": "Ly8gQ29weXJpZ2h0IDIwMjQsIEJhdHRlbGxlIEVuZXJneSBBbGxpYW5jZSwgTExDLCBBTEwgUklHSFRTIFJFU0VSVkVECiNpbmNsdWRlIDxzdHJpbmc+CiNpbmNsdWRlIDxpb3N0cmVhbT4KI2luY2x1ZGUgPGFsZ29yaXRobT4KI2luY2x1ZGUgPHJhbmRvbT4KI2luY2x1ZGUgPGhpbHRpL3J0L2xpYmhpbHRpLmg+CiNpbmNsdWRlIDxzcGljeS9ydC9saWJzcGljeS5oPgoKbmFtZXNwYWNlIEhBUlRfSVBfQ09OVkVSU0lPTgp7CiAgICBzdGQ6OnN0cmluZyBsYXRpbjFDb252ZXJzaW9uKGNvbnN0IGhpbHRpOjpydDo6Qnl0ZXMgJmRhdGEpICAgIHsKICAgICAgICBzdGQ6OnN0cmluZyByZXR1cm5WYWx1ZTsKICAgICAgICBjb25zdCBjaGFyICpjaGFyX3B0ciA9IChjb25zdCBjaGFyICopIGRhdGEuZGF0YSgpOwogICAgICAgIGZvcihzdGQ6OnNpemVfdCBpID0gMDsgaSA8IGRhdGEuc2l6ZSgpOyArK2kpCiAgICAgICAgewogICAgICAgICAgICAvL2lmKDAgPT0gY2hhcl9wdHJbaV0pCiAgICAgICAgICAgIC8vewogICAgICAgICAgICAvLyAgICBicmVhazsKICAgICAgICAgICAgLy99CiAgICAgICAgICAgIHJldHVyblZhbHVlICs9IGNoYXJfcHRyW2ldOwogICAgICAgIH0KICAgICAgICByZXR1cm4gcmV0dXJuVmFsdWU7CiAgICB9CgogICAgc3RkOjpzdHJpbmcgZGF0ZUNvbnZlcnNpb24oY29uc3QgaGlsdGk6OnJ0OjpCeXRlcyAmZGF0YSkgICAgewogICAgICAgIGlmKGRhdGEuc2l6ZSgpIDwgMykKICAgICAgICB7CiAgICAgICAgICAgIHByaW50ZigiW2Vycm9yXSBEYXRlIFR5cGUgSW1wcm9wZXIgQnl0ZSBMZW5ndGggKCVsaSksIG11c3QgYmUgM1xuIiwgKGxvbmcpIGRhdGEuc2l6ZSgpKTsKICAgICAgICAgICAgcmV0dXJuICIiOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgY2hhciAqY2hhcl9wdHIgPSAoY29uc3QgY2hhciAqKSBkYXRhLmRhdGEoKTsKCiAgICAgICAgdW5zaWduZWQgY2hhciBkYXkgPSBjaGFyX3B0clswXTsKICAgICAgICB1bnNpZ25lZCBjaGFyIG1vbnRoID0gY2hhcl9wdHJbMV07CiAgICAgICAgdW5zaWduZWQgY2hhciBzaG9ydFllYXIgPSBjaGFyX3B0clsyXTsKICAgICAgICB1bnNpZ25lZCBpbnQgbG9uZ1llYXIgPSAxOTAwICsgc2hvcnRZZWFyOwoKICAgICAgICByZXR1cm4gc3RkOjp0b19zdHJpbmcobW9udGgpICsgIi0iICsKICAgICAgICAgICAgICAgc3RkOjp0b19zdHJpbmcoZGF5KSArICItIiArCiAgICAgICAgICAgICAgIHN0ZDo6dG9fc3RyaW5nKGxvbmdZZWFyKTsKICAgIH0KCiAgICBzdGQ6OnN0cmluZyB0aW1lQ29udmVyc2lvbihjb25zdCBoaWx0aTo6cnQ6OkJ5dGVzICZkYXRhKSAgICB7CiAgICAgICAgY29uc3QgdW5zaWduZWQgaW50IE1JTExJU0VDT05EX1BBUlRTID0gMzI7CiAgICAgICAgY29uc3QgdW5zaWduZWQgaW50IFNFQ09ORFNfUEVSX01JTlVURSA9IDYwOwogICAgICAgIGNvbnN0IHVuc2lnbmVkIGludCBNSU5VVEVTX1BFUl9IT1VSID0gNjA7CiAgICAgICAgaWYoZGF0YS5zaXplKCkgPCA0KQogICAgICAgIHsKICAgICAgICAgICAgcHJpbnRmKCJbZXJyb3JdIFRpbWUgVHlwZSBJbXByb3BlciBCeXRlIExlbmd0aCAoJWxpKSwgbXVzdCBiZSA0XG4iLCAobG9uZykgZGF0YS5zaXplKCkpOwogICAgICAgICAgICByZXR1cm4gIiI7CiAgICAgICAgfQogICAgICAgIGNvbnN0IGNoYXIgKmNoYXJfcHRyID0gKGNvbnN0IGNoYXIgKikgZGF0YS5kYXRhKCk7CiAgICAgICAgdW5zaWduZWQgaW50IHRpbWUgPSAwOwogICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCA0OyArK2kpCiAgICAgICAgewogICAgICAgICAgICB0aW1lIDw8PSA4OwogICAgICAgICAgICB0aW1lIHw9ICh1bnNpZ25lZCBjaGFyKWNoYXJfcHRyW2ldOwogICAgICAgIH0KICAgICAgICAvL3ByaW50ZigiVGltZTogJXVcbiIsIHRpbWUpOwogICAgICAgIGZsb2F0IGZyYWN0aW9uUGFydCA9IChmbG9hdCkodGltZSAlIE1JTExJU0VDT05EX1BBUlRTKS8oZmxvYXQpTUlMTElTRUNPTkRfUEFSVFM7CiAgICAgICAgdW5zaWduZWQgaW50IHRvdGFsU2Vjb25kcyA9IHRpbWUgLyBNSUxMSVNFQ09ORF9QQVJUUzsgLy8gU2FtZSBhcyB0aW1lID4+IDUKICAgICAgICB1bnNpZ25lZCBpbnQgc2Vjb25kc1BhcnQgPSB0b3RhbFNlY29uZHMgJSBTRUNPTkRTX1BFUl9NSU5VVEU7CiAgICAgICAgdW5zaWduZWQgaW50IHRvdGFsTWludXRlcyA9IHRvdGFsU2Vjb25kcyAvIFNFQ09ORFNfUEVSX01JTlVURTsKICAgICAgICB1bnNpZ25lZCBpbnQgbWludXRlc1BhcnQgPSB0b3RhbE1pbnV0ZXMgJSBNSU5VVEVTX1BFUl9IT1VSOwogICAgICAgIHVuc2lnbmVkIGludCBob3Vyc1BhcnQgPSB0b3RhbE1pbnV0ZXMgLyBNSU5VVEVTX1BFUl9IT1VSOwoKICAgICAgICBzdGQ6OnN0cmluZyByZXR1cm5TdHJpbmcgPSAiIjsKICAgICAgICBzdGQ6OnN0cmluZyB0ZW1wU3RyaW5nID0gIiI7CiAgICAgICAgaWYoMCA8IHNlY29uZHNQYXJ0IHx8IDAuMCA8IGZyYWN0aW9uUGFydCkKICAgICAgICB7CiAgICAgICAgICAgIHJldHVyblN0cmluZyA9IHN0ZDo6dG9fc3RyaW5nKGZyYWN0aW9uUGFydCArIHNlY29uZHNQYXJ0KSArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICIgc2Vjb25kcyBzaW5jZSBtaWRuaWdodCI7CiAgICAgICAgfQogICAgICAgIGlmKDAgPCBtaW51dGVzUGFydCkKICAgICAgICB7CiAgICAgICAgICAgIHRlbXBTdHJpbmcgPSBzdGQ6OnRvX3N0cmluZyhtaW51dGVzUGFydCkgKyAiIG1pbnV0ZXMiOwogICAgICAgICAgICBpZigiIiAhPSByZXR1cm5TdHJpbmcpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHRlbXBTdHJpbmcgKz0gIiwgIjsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm5TdHJpbmcgPSB0ZW1wU3RyaW5nICsgcmV0dXJuU3RyaW5nOwogICAgICAgIH0KICAgICAgICBpZigwIDwgaG91cnNQYXJ0KQogICAgICAgIHsKICAgICAgICAgICAgdGVtcFN0cmluZyA9IHN0ZDo6dG9fc3RyaW5nKGhvdXJzUGFydCkgKyAiIGhvdXJzIjsKICAgICAgICAgICAgaWYoIiIgIT0gcmV0dXJuU3RyaW5nKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB0ZW1wU3RyaW5nICs9ICIsICI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuU3RyaW5nID0gdGVtcFN0cmluZyArIHJldHVyblN0cmluZzsKICAgICAgICB9CgogICAgICAgIHJldHVybiByZXR1cm5TdHJpbmc7CiAgICB9CgogICAgc3RkOjpzdHJpbmcgcGFja2VkQ29udmVyc2lvbihjb25zdCBoaWx0aTo6cnQ6OkJ5dGVzICZkYXRhKSAgICB7CiAgICAgICAgY29uc3QgaW50IElOUFVUX0NIQVJTID0gMzsKICAgICAgICBjb25zdCBpbnQgT1VUUFVUX0NIQVJTID0gNDsKICAgICAgICBjb25zdCBpbnQgQklUU19QRVJfQllURSA9IDg7CiAgICAgICAgY29uc3QgaW50IE5FRURFRF9CSVRTID0gQklUU19QRVJfQllURSAvIE9VVFBVVF9DSEFSUyAqIElOUFVUX0NIQVJTOwogICAgICAgIC8vIE1BUCBmcm9tIFRTMjAwOTkgKHYxMS4wKSA1LjEuMSwgVGFibGUgMQogICAgICAgIC8vIE5vdGU6IHRoZXJlIGFyZSBvdGhlciB3YXlzIHRvIGRvIHRoaXMsIHRoaXMganVzdCBzZWVtcyBlYXN5IGZvciBub3cuCiAgICAgICAgY29uc3Qgc3RkOjpzdHJpbmcgTUFQID0gIkBBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWltcXF1eXyAhXCIjJCUmJygpKissLS4vMDEyMzQ1Njc4OTo7PD0+PyI7CiAgICAgICAgICAgIAogICAgICAgIGlmKDAgIT0gZGF0YS5zaXplKCkgJSBJTlBVVF9DSEFSUykKICAgICAgICB7CiAgICAgICAgICAgIHByaW50ZigiW2Vycm9yXSBQYWNrZWQgVHlwZSBJbXByb3BlciBCeXRlIExlbmd0aCAoJWxpKSwgbXVzdCBiZSBkaXZpc2libGUgYnkgJWlcbiIsIChsb25nKSBkYXRhLnNpemUoKSwgSU5QVVRfQ0hBUlMpOwogICAgICAgICAgICByZXR1cm4gIiI7CiAgICAgICAgfQogICAgICAgIHN0ZDo6c3RyaW5nIG91dHB1dFN0cmluZzsKCiAgICAgICAgdW5zaWduZWQgY2hhciB0ZW1wQ2hhciA9IDA7CiAgICAgICAgaW50IHByb2Nlc3NlZEJpdHMgPSAwOwogICAgICAgIGNvbnN0IGNoYXIgKmNoYXJfcHRyID0gKGNvbnN0IGNoYXIgKikgZGF0YS5kYXRhKCk7CiAgICAgICAgZm9yKHN0ZDo6c2l6ZV90IGkgPSAwOyBpIDwgZGF0YS5zaXplKCk7ICsraSkKICAgICAgICB7CiAgICAgICAgICAgIC8vIENhbiB3ZSBiZSBzbWFydGVyIGFib3V0IHRoaXM/IChpLmUuLCBub3QgcmVhZCBqdXN0IG9uZSBiaXQgYXQgYSB0aW1lKQogICAgICAgICAgICBmb3IoaW50IGogPSBCSVRTX1BFUl9CWVRFIC0gMTsgaiA+PSAwOyAtLWopCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIC8vIFNoaWZ0IGN1cnJlbnQgYml0cwogICAgICAgICAgICAgICAgdGVtcENoYXIgPDw9IDE7CiAgICAgICAgICAgICAgICAvLyBSZWFkIHRoZSBuZXh0IGJpdAogICAgICAgICAgICAgICAgaWYoY2hhcl9wdHJbaV0gJiAoMSA8PCBqKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAvLyBCaXQgd2FzIHNldCwgY29weSBpdCBvdmVyCiAgICAgICAgICAgICAgICAgICAgdGVtcENoYXIgfD0gMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmKDAgPT0gKytwcm9jZXNzZWRCaXRzICUgTkVFREVEX0JJVFMpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgLy8gV2UgaGF2ZSBjb2xsZWN0ZWQgdGhlIG5leHQgc2V0IG9mIE5FRURFRF9CSVRTLCB0aW1lIHRvIG1hcCBhbmQKICAgICAgICAgICAgICAgICAgICAvLyByZXR1cm4gYSBjaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICBpZih0ZW1wQ2hhciA8IE1BUC5zaXplKCkpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXRTdHJpbmcgKz0gTUFQW3RlbXBDaGFyXTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnRmKCJbZXJyb3JdIFBhY2tlZCBUeXBlIEltcHJvcGVyIENoYXJhY3RlciBFbmNvZGluZ1xuIik7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAiIjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgLy8gUmVzZXQgdGhpbmdzIGluIHByZXBhcmF0aW9uIGZvciB0aGUgbmV4dCBzZXQgb2YgTkVFREVEX0JJVFMKICAgICAgICAgICAgICAgICAgICBwcm9jZXNzZWRCaXRzID0gMDsKICAgICAgICAgICAgICAgICAgICB0ZW1wQ2hhciA9IDA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJldHVybiBvdXRwdXRTdHJpbmc7CiAgICB9Cgp9Cgo=",
    "signatureFile": "IyBDb3B5cmlnaHQgKGMpIDIwMjQgYnkgQmF0dGVsbGUgRW5lcmd5IEFsbGlhbmNlCgojIFRoZSBzcGVjaWZpYyB2ZXJzaW9uIG9mIEhBUlQtSVAgdXNlZCB0byBjcmVhdGUgdGhpcyBwYXJzZXIKIyBGaXJzdCBieXRlOiAweDAyIGFjY29yZGluZyB0byBzcGVjLCAweDAxIGFjY29yZGluZyB0byBvdXIgdGVzdCBkYXRhCiMgU2Vjb25kIGJ5dGU6IDB4MDAgLSAweDAyLCAweDBGCiMgVGhpcmQgYnl0ZTogMHgwMCAtIDB4MDUKIyBGb3VydGggYnl0ZTogMHgwMCwgMHgwMiwgMHgwNSwgMHgwNiwgMHgwOCwgMHgwOSwgMHgwZSwgMHgwZiwgMHgxMCwgMHgxZQoKc2lnbmF0dXJlIGRwZF9oYXJ0X2lwIHsKICAgICNwYXlsb2FkIC9eW1x4MDFceDAyXVtceDAwLVx4MDJceDBmXVtceDAwLVx4MDVdW1x4MDBceDAyXHgwNVx4MDZceDA4XHgwOVx4MGVceDBmXHgxMFx4MWVdLwogICAgcGF5bG9hZC9eW1x4MDFceDAyXVtceDAwLVx4MDJceDBmXShceDAwW1x4MDBceDA1XHgwNlx4MDhceDA5XHgwZVx4MGZceDEwXHgxZV1bXHgwMC1ceGZmXXsyfVx4MDBceDBkW1x4MDAtXHhmZl17NX0pfChceDAxW1x4MDBceDA2XVtceDAwLVx4ZmZdezJ9XHgwMFx4MDgpfChceDAyW1x4MDBceDA2XVtceDAwLVx4ZmZdezJ9XHgwMFx4MDgpfChceDAzW1x4MDBceDA2XHgxMF1bXHgwMC1ceGZmXXs2fShbXHgwMC1ceGZmXXs0fSk/W1x4MDAtXHhmZl17Myx9KXwoXHgwNFtceDAwXHgwNlx4MTBdW1x4MDAtXHhmZl17Nn0oW1x4MDAtXHhmZl17Myx9KSspfChceDA1W1x4MDBceDA2XHgwOF1bXHgwMC1ceGZmXXs2fShbXHgwMC1ceGZmXXsxN31bXHgwMC1ceDA3XVtceDAwLVx4ZmZdezJ9KFtceDAwLVx4ZmZdezQwfVtceDAwLVx4MWZdW1x4MDAtXHhmZl17MTZ9KSspPykvCn0KCnNpZ25hdHVyZSBkcGRfaGFydF9pcF90Y3AgewogIGlwLXByb3RvID09IHRjcAogIHJlcXVpcmVzLXNpZ25hdHVyZSBkcGRfaGFydF9pcAogIGVuYWJsZSAic3BpY3lfSEFSVF9JUF9UQ1AiCn0KCnNpZ25hdHVyZSBkcGRfaGFydF9pcF91ZHAgewogIGlwLXByb3RvID09IHVkcAogIHJlcXVpcmVzLXNpZ25hdHVyZSBkcGRfaGFydF9pcAogIGVuYWJsZSAic3BpY3lfSEFSVF9JUF9VRFAiCn0K",
    "CustomFieldTypes": [
        {
            "name": "latin-1",
            "interpretingFunction": "latin1Conversion",
            "returnType": "string"
        },
        {
            "name": "Date",
            "interpretingFunction": "dateConversion",
            "returnType": "string"
        },
        {
            "name": "Time",
            "interpretingFunction": "timeConversion",
            "returnType": "string"
        },
        {
            "name": "Packed",
            "interpretingFunction": "packedConversion",
            "returnType": "string"
        }
    ],
    "EntryPoint": "general.Message",
    "Scopes": [
        "general",
        "common_commands",
        "universal_commands"
    ]
}

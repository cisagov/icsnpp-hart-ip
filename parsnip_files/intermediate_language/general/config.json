{
    "ParsnipVersion": "1.0",
    "Protocol": "HART_IP",
    "protocolShortDescription": "HART-IP is the IP extension of the Highway Addressable Remote Transducer (HART) protocol.",
    "protocolLongDescription": "HART-IP is the IP extension of the Highway Addressable Remote Transducer (HART) protocol.\nThe HART protocol is a hybrid analog+digital industrial automation open protocol.\nIt is currently maintained by the FieldComm Group (https://www.fieldcommgroup.org/).",
    "Ports": [
        {
            "protocol": "tcp",
            "port": 5094
        },
        {
            "protocol": "udp",
            "port": 5094
        }
    ],
    "usesTCP": true,
    "usesUDP": true,
    "usesLayer2": false,
    "conversionFile": "Ly8gQ29weXJpZ2h0IDIwMjQsIEJhdHRlbGxlIEVuZXJneSBBbGxpYW5jZSwgTExDLCBBTEwgUklHSFRTIFJFU0VSVkVECiNpbmNsdWRlIDxzdHJpbmc+CiNpbmNsdWRlIDxpb3N0cmVhbT4KI2luY2x1ZGUgPGFsZ29yaXRobT4KI2luY2x1ZGUgPHJhbmRvbT4KI2luY2x1ZGUgPGhpbHRpL3J0L2xpYmhpbHRpLmg+CiNpbmNsdWRlIDxzcGljeS9ydC9saWJzcGljeS5oPgoKbmFtZXNwYWNlIEhBUlRfSVBfQ09OVkVSU0lPTgp7CiAgICBzdGQ6OnN0cmluZyBsYXRpbjFDb252ZXJzaW9uKGNvbnN0IGhpbHRpOjpydDo6Qnl0ZXMgJmRhdGEpICAgIHsKICAgICAgICBzdGQ6OnN0cmluZyByZXR1cm5WYWx1ZTsKICAgICAgICBjb25zdCBjaGFyICpjaGFyX3B0ciA9IChjb25zdCBjaGFyICopIGRhdGEuZGF0YSgpOwogICAgICAgIGZvcihzdGQ6OnNpemVfdCBpID0gMDsgaSA8IGRhdGEuc2l6ZSgpOyArK2kpCiAgICAgICAgewogICAgICAgICAgICAvL2lmKDAgPT0gY2hhcl9wdHJbaV0pCiAgICAgICAgICAgIC8vewogICAgICAgICAgICAvLyAgICBicmVhazsKICAgICAgICAgICAgLy99CiAgICAgICAgICAgIHJldHVyblZhbHVlICs9IGNoYXJfcHRyW2ldOwogICAgICAgIH0KICAgICAgICByZXR1cm4gcmV0dXJuVmFsdWU7CiAgICB9CgogICAgc3RkOjpzdHJpbmcgZGF0ZUNvbnZlcnNpb24oY29uc3QgaGlsdGk6OnJ0OjpCeXRlcyAmZGF0YSkgICAgewogICAgICAgIGlmKGRhdGEuc2l6ZSgpIDwgMykKICAgICAgICB7CiAgICAgICAgICAgIHByaW50ZigiW2Vycm9yXSBEYXRlIFR5cGUgSW1wcm9wZXIgQnl0ZSBMZW5ndGggKCVsaSksIG11c3QgYmUgM1xuIiwgZGF0YS5zaXplKCkpOwogICAgICAgICAgICByZXR1cm4gIiI7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBjaGFyICpjaGFyX3B0ciA9IChjb25zdCBjaGFyICopIGRhdGEuZGF0YSgpOwoKICAgICAgICB1bnNpZ25lZCBjaGFyIGRheSA9IGNoYXJfcHRyWzBdOwogICAgICAgIHVuc2lnbmVkIGNoYXIgbW9udGggPSBjaGFyX3B0clsxXTsKICAgICAgICB1bnNpZ25lZCBjaGFyIHNob3J0WWVhciA9IGNoYXJfcHRyWzJdOwogICAgICAgIHVuc2lnbmVkIGludCBsb25nWWVhciA9IDE5MDAgKyBzaG9ydFllYXI7CgogICAgICAgIHJldHVybiBzdGQ6OnRvX3N0cmluZyhtb250aCkgKyAiLSIgKwogICAgICAgICAgICAgICBzdGQ6OnRvX3N0cmluZyhkYXkpICsgIi0iICsKICAgICAgICAgICAgICAgc3RkOjp0b19zdHJpbmcobG9uZ1llYXIpOwogICAgfQoKICAgIHN0ZDo6c3RyaW5nIHRpbWVDb252ZXJzaW9uKGNvbnN0IGhpbHRpOjpydDo6Qnl0ZXMgJmRhdGEpICAgIHsKICAgICAgICBjb25zdCB1bnNpZ25lZCBpbnQgTUlMTElTRUNPTkRfUEFSVFMgPSAzMjsKICAgICAgICBjb25zdCB1bnNpZ25lZCBpbnQgU0VDT05EU19QRVJfTUlOVVRFID0gNjA7CiAgICAgICAgY29uc3QgdW5zaWduZWQgaW50IE1JTlVURVNfUEVSX0hPVVIgPSA2MDsKICAgICAgICBpZihkYXRhLnNpemUoKSA8IDQpCiAgICAgICAgewogICAgICAgICAgICBwcmludGYoIltlcnJvcl0gVGltZSBUeXBlIEltcHJvcGVyIEJ5dGUgTGVuZ3RoICglbGkpLCBtdXN0IGJlIDRcbiIsIGRhdGEuc2l6ZSgpKTsKICAgICAgICAgICAgcmV0dXJuICIiOwogICAgICAgIH0KICAgICAgICBjb25zdCBjaGFyICpjaGFyX3B0ciA9IChjb25zdCBjaGFyICopIGRhdGEuZGF0YSgpOwogICAgICAgIHVuc2lnbmVkIGludCB0aW1lID0gMDsKICAgICAgICBmb3IoaW50IGkgPSAwOyBpIDwgNDsgKytpKQogICAgICAgIHsKICAgICAgICAgICAgdGltZSA8PD0gODsKICAgICAgICAgICAgdGltZSB8PSAodW5zaWduZWQgY2hhciljaGFyX3B0cltpXTsKICAgICAgICB9CiAgICAgICAgLy9wcmludGYoIlRpbWU6ICV1XG4iLCB0aW1lKTsKICAgICAgICBmbG9hdCBmcmFjdGlvblBhcnQgPSAoZmxvYXQpKHRpbWUgJSBNSUxMSVNFQ09ORF9QQVJUUykvKGZsb2F0KU1JTExJU0VDT05EX1BBUlRTOwogICAgICAgIHVuc2lnbmVkIGludCB0b3RhbFNlY29uZHMgPSB0aW1lIC8gTUlMTElTRUNPTkRfUEFSVFM7IC8vIFNhbWUgYXMgdGltZSA+PiA1CiAgICAgICAgdW5zaWduZWQgaW50IHNlY29uZHNQYXJ0ID0gdG90YWxTZWNvbmRzICUgU0VDT05EU19QRVJfTUlOVVRFOwogICAgICAgIHVuc2lnbmVkIGludCB0b3RhbE1pbnV0ZXMgPSB0b3RhbFNlY29uZHMgLyBTRUNPTkRTX1BFUl9NSU5VVEU7CiAgICAgICAgdW5zaWduZWQgaW50IG1pbnV0ZXNQYXJ0ID0gdG90YWxNaW51dGVzICUgTUlOVVRFU19QRVJfSE9VUjsKICAgICAgICB1bnNpZ25lZCBpbnQgaG91cnNQYXJ0ID0gdG90YWxNaW51dGVzIC8gTUlOVVRFU19QRVJfSE9VUjsKCiAgICAgICAgc3RkOjpzdHJpbmcgcmV0dXJuU3RyaW5nID0gIiI7CiAgICAgICAgc3RkOjpzdHJpbmcgdGVtcFN0cmluZyA9ICIiOwogICAgICAgIGlmKDAgPCBzZWNvbmRzUGFydCB8fCAwLjAgPCBmcmFjdGlvblBhcnQpCiAgICAgICAgewogICAgICAgICAgICByZXR1cm5TdHJpbmcgPSBzdGQ6OnRvX3N0cmluZyhmcmFjdGlvblBhcnQgKyBzZWNvbmRzUGFydCkgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAiIHNlY29uZHMgc2luY2UgbWlkbmlnaHQiOwogICAgICAgIH0KICAgICAgICBpZigwIDwgbWludXRlc1BhcnQpCiAgICAgICAgewogICAgICAgICAgICB0ZW1wU3RyaW5nID0gc3RkOjp0b19zdHJpbmcobWludXRlc1BhcnQpICsgIiBtaW51dGVzIjsKICAgICAgICAgICAgaWYoIiIgIT0gcmV0dXJuU3RyaW5nKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB0ZW1wU3RyaW5nICs9ICIsICI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuU3RyaW5nID0gdGVtcFN0cmluZyArIHJldHVyblN0cmluZzsKICAgICAgICB9CiAgICAgICAgaWYoMCA8IGhvdXJzUGFydCkKICAgICAgICB7CiAgICAgICAgICAgIHRlbXBTdHJpbmcgPSBzdGQ6OnRvX3N0cmluZyhob3Vyc1BhcnQpICsgIiBob3VycyI7CiAgICAgICAgICAgIGlmKCIiICE9IHJldHVyblN0cmluZykKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdGVtcFN0cmluZyArPSAiLCAiOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVyblN0cmluZyA9IHRlbXBTdHJpbmcgKyByZXR1cm5TdHJpbmc7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gcmV0dXJuU3RyaW5nOwogICAgfQoKICAgIHN0ZDo6c3RyaW5nIHBhY2tlZENvbnZlcnNpb24oY29uc3QgaGlsdGk6OnJ0OjpCeXRlcyAmZGF0YSkgICAgewogICAgICAgIGNvbnN0IGludCBJTlBVVF9DSEFSUyA9IDM7CiAgICAgICAgY29uc3QgaW50IE9VVFBVVF9DSEFSUyA9IDQ7CiAgICAgICAgY29uc3QgaW50IEJJVFNfUEVSX0JZVEUgPSA4OwogICAgICAgIGNvbnN0IGludCBORUVERURfQklUUyA9IEJJVFNfUEVSX0JZVEUgLyBPVVRQVVRfQ0hBUlMgKiBJTlBVVF9DSEFSUzsKICAgICAgICAvLyBNQVAgZnJvbSBUUzIwMDk5ICh2MTEuMCkgNS4xLjEsIFRhYmxlIDEKICAgICAgICAvLyBOb3RlOiB0aGVyZSBhcmUgb3RoZXIgd2F5cyB0byBkbyB0aGlzLCB0aGlzIGp1c3Qgc2VlbXMgZWFzeSBmb3Igbm93LgogICAgICAgIGNvbnN0IHN0ZDo6c3RyaW5nIE1BUCA9ICJAQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVpbXFxdXl8gIVwiIyQlJicoKSorLC0uLzAxMjM0NTY3ODk6Ozw9Pj8iOwogICAgICAgICAgICAKICAgICAgICBpZigwICE9IGRhdGEuc2l6ZSgpICUgSU5QVVRfQ0hBUlMpCiAgICAgICAgewogICAgICAgICAgICBwcmludGYoIltlcnJvcl0gUGFja2VkIFR5cGUgSW1wcm9wZXIgQnl0ZSBMZW5ndGggKCVsaSksIG11c3QgYmUgZGl2aXNpYmxlIGJ5ICVpXG4iLCBkYXRhLnNpemUoKSwgSU5QVVRfQ0hBUlMpOwogICAgICAgICAgICByZXR1cm4gIiI7CiAgICAgICAgfQogICAgICAgIHN0ZDo6c3RyaW5nIG91dHB1dFN0cmluZzsKCiAgICAgICAgdW5zaWduZWQgY2hhciB0ZW1wQ2hhciA9IDA7CiAgICAgICAgaW50IHByb2Nlc3NlZEJpdHMgPSAwOwogICAgICAgIGNvbnN0IGNoYXIgKmNoYXJfcHRyID0gKGNvbnN0IGNoYXIgKikgZGF0YS5kYXRhKCk7CiAgICAgICAgZm9yKHN0ZDo6c2l6ZV90IGkgPSAwOyBpIDwgZGF0YS5zaXplKCk7ICsraSkKICAgICAgICB7CiAgICAgICAgICAgIC8vIENhbiB3ZSBiZSBzbWFydGVyIGFib3V0IHRoaXM/IChpLmUuLCBub3QgcmVhZCBqdXN0IG9uZSBiaXQgYXQgYSB0aW1lKQogICAgICAgICAgICBmb3IoaW50IGogPSBCSVRTX1BFUl9CWVRFIC0gMTsgaiA+PSAwOyAtLWopCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIC8vIFNoaWZ0IGN1cnJlbnQgYml0cwogICAgICAgICAgICAgICAgdGVtcENoYXIgPDw9IDE7CiAgICAgICAgICAgICAgICAvLyBSZWFkIHRoZSBuZXh0IGJpdAogICAgICAgICAgICAgICAgaWYoY2hhcl9wdHJbaV0gJiAoMSA8PCBqKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAvLyBCaXQgd2FzIHNldCwgY29weSBpdCBvdmVyCiAgICAgICAgICAgICAgICAgICAgdGVtcENoYXIgfD0gMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmKDAgPT0gKytwcm9jZXNzZWRCaXRzICUgTkVFREVEX0JJVFMpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgLy8gV2UgaGF2ZSBjb2xsZWN0ZWQgdGhlIG5leHQgc2V0IG9mIE5FRURFRF9CSVRTLCB0aW1lIHRvIG1hcCBhbmQKICAgICAgICAgICAgICAgICAgICAvLyByZXR1cm4gYSBjaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICBpZih0ZW1wQ2hhciA8IE1BUC5zaXplKCkpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXRTdHJpbmcgKz0gTUFQW3RlbXBDaGFyXTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnRmKCJbZXJyb3JdIFBhY2tlZCBUeXBlIEltcHJvcGVyIENoYXJhY3RlciBFbmNvZGluZ1xuIik7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAiIjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgLy8gUmVzZXQgdGhpbmdzIGluIHByZXBhcmF0aW9uIGZvciB0aGUgbmV4dCBzZXQgb2YgTkVFREVEX0JJVFMKICAgICAgICAgICAgICAgICAgICBwcm9jZXNzZWRCaXRzID0gMDsKICAgICAgICAgICAgICAgICAgICB0ZW1wQ2hhciA9IDA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJldHVybiBvdXRwdXRTdHJpbmc7CiAgICB9Cgp9Cg==",
    "signatureFile": "IyBDb3B5cmlnaHQgKGMpIDIwMjQgYnkgQmF0dGVsbGUgRW5lcmd5IEFsbGlhbmNlCgojIFRoZSBzcGVjaWZpYyB2ZXJzaW9uIG9mIEhBUlQtSVAgdXNlZCB0byBjcmVhdGUgdGhpcyBwYXJzZXIKIyBGaXJzdCBieXRlOiAweDAyIGFjY29yZGluZyB0byBzcGVjLCAweDAxIGFjY29yZGluZyB0byBvdXIgdGVzdCBkYXRhCiMgU2Vjb25kIGJ5dGU6IDB4MDAgLSAweDAyLCAweDBGCiMgVGhpcmQgYnl0ZTogMHgwMCAtIDB4MDUKIyBGb3VydGggYnl0ZTogMHgwMCwgMHgwMiwgMHgwNSwgMHgwNiwgMHgwOCwgMHgwOSwgMHgwZSwgMHgwZiwgMHgxMCwgMHgxZQoKc2lnbmF0dXJlIGRwZF9oYXJ0X2lwIHsKICAgICNwYXlsb2FkIC9eW1x4MDFceDAyXVtceDAwLVx4MDJceDBmXVtceDAwLVx4MDVdW1x4MDBceDAyXHgwNVx4MDZceDA4XHgwOVx4MGVceDBmXHgxMFx4MWVdLwogICAgcGF5bG9hZC9eW1x4MDFceDAyXVtceDAwLVx4MDJceDBmXShceDAwW1x4MDBceDA1XHgwNlx4MDhceDA5XHgwZVx4MGZceDEwXHgxZV1bXHgwMC1ceGZmXXsyfVx4MDBceDBkW1x4MDAtXHhmZl17NX0pfChceDAxW1x4MDBceDA2XVtceDAwLVx4ZmZdezJ9XHgwMFx4MDgpfChceDAyW1x4MDBceDA2XVtceDAwLVx4ZmZdezJ9XHgwMFx4MDgpfChceDAzW1x4MDBceDA2XHgxMF1bXHgwMC1ceGZmXXs2fShbXHgwMC1ceGZmXXs0fSk/W1x4MDAtXHhmZl17Myx9KXwoXHgwNFtceDAwXHgwNlx4MTBdW1x4MDAtXHhmZl17Nn0oW1x4MDAtXHhmZl17Myx9KSspfChceDA1W1x4MDBceDA2XHgwOF1bXHgwMC1ceGZmXXs2fShbXHgwMC1ceGZmXXsxN31bXHgwMC1ceDA3XVtceDAwLVx4ZmZdezJ9KFtceDAwLVx4ZmZdezQwfVtceDAwLVx4MWZdW1x4MDAtXHhmZl17MTZ9KSspPykvCn0KCnNpZ25hdHVyZSBkcGRfaGFydF9pcF90Y3AgewogIGlwLXByb3RvID09IHRjcAogIHJlcXVpcmVzLXNpZ25hdHVyZSBkcGRfaGFydF9pcAogIGVuYWJsZSAic3BpY3lfSEFSVF9JUF9UQ1AiCn0KCnNpZ25hdHVyZSBkcGRfaGFydF9pcF91ZHAgewogIGlwLXByb3RvID09IHVkcAogIHJlcXVpcmVzLXNpZ25hdHVyZSBkcGRfaGFydF9pcAogIGVuYWJsZSAic3BpY3lfSEFSVF9JUF9VRFAiCn0K",
    "CustomFieldTypes": [
        {
            "name": "latin-1",
            "interpretingFunction": "latin1Conversion",
            "returnType": "string"
        },
        {
            "name": "Date",
            "interpretingFunction": "dateConversion",
            "returnType": "string"
        },
        {
            "name": "Time",
            "interpretingFunction": "timeConversion",
            "returnType": "string"
        },
        {
            "name": "Packed",
            "interpretingFunction": "packedConversion",
            "returnType": "string"
        }
    ],
    "EntryPoint": "general.Message",
    "Scopes": [
        "general",
        "common_commands",
        "universal_commands"
    ]
}